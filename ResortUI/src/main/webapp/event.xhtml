<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <body>
    <ui:composition template="./common/template.xhtml">
        
        <ui:define name="title">Event reserveren</ui:define>

        <ui:define name="navbar"><h1>Event reserveren</h1></ui:define>
        
        <ui:define name="content">

            <ui:fragment rendered="${sessionDto.userDto.level &lt; 3}">
                <script type="text/javascript">window.location.href = "redirect.xhtml";</script>
            </ui:fragment>
            
            <h:form>  
                <p:growl id="messages" showDetail="true" />
 
                <h:panelGrid columnClasses="value">
                    <h3 style="margin-top: 0">Aanpasbare kalender</h3>

                    <p:schedule id="schedule" value="#{eventFacade.eventModel}"  widgetVar="myschedule" timeZone="GMT+2" locale="nl" timeFormat="HH:mm">

                        <p:ajax event="dateSelect" listener="#{eventFacade.onDateSelect}" update="eventDetails" oncomplete="PF('eventDialog').show();" />
                        <p:ajax event="eventSelect" listener="#{eventFacade.onEventSelect}" update="eventDetails" oncomplete="PF('eventDialog').show();" />
                        <p:ajax event="eventMove" listener="#{eventFacade.onEventMove}" update="messages" />
                        <p:ajax event="eventResize" listener="#{eventFacade.onEventResize}" update="messages" />

                    </p:schedule>
                </h:panelGrid>
 
                <p:dialog widgetVar="eventDialog" header="Event Details" showEffect="clip" hideEffect="clip">
                    <h:messages styleClass="alert alert-danger" p:role="alert"></h:messages>
                    <h:panelGrid id="eventDetails" columns="4">
                        <p:row>
                                <h:outputLabel for="Evenementnaam" value="Evenementnaam:" />
                        </p:row>
                        <p:row>       
                                <p:inputText id="Evenementnaam" value="#{event.dto.detail.eventname}" required="true" />
                        </p:row>
                                              
                        <p:row>
                                <h:outputLabel for="Locatie" value="Locatie:" />
                        </p:row>
                        <p:row>
                                <p:selectOneMenu required="true" id="Locatie" value="${event.dto.detail.locationName}" style="width:415px; margin-left: 5px;" requiredMessage="Gelieve een eventtype te kiezen." validatorMessage="Gelieve een eventtype te kiezen.">
                                    <f:selectItem itemLabel="Kies locatie"  noSelectionOption="true" />
                                    <f:selectItems value="${event.dto.locationList}" />
                                </p:selectOneMenu>      
                        </p:row>
                        
                        <p:row>
                                <h:outputLabel for="Startdatum" value="Startdatum:" />
                        </p:row>
                        <p:row>
                                <p:calendar pattern="dd/MM/yyyy" id="popup1"  locale="nl" value="${event.dto.detail.startDate}" required="true" requiredMessage="Gelieve een startdatum in te vullen."/>
                                <p:inputMask id="Begintijd" placeholder="Starttijd"  value="#{event.dto.detail.startTime}" mask="99:99" required="true" requiredMessage="Gelieve een starttijd in te vullen.">
                                    <f:convertDateTime pattern="HH:mm" timeZone="GMT+0" />
                                </p:inputMask>
                        </p:row>

                        <p:row>
                                <h:outputLabel for="Einddatum" value="Einddatum:" />
                        </p:row>
                        <p:row>
                                <p:calendar pattern="dd/MM/yyyy" id="popup2"  locale="nl" value="${event.dto.detail.endDate}" required="true" requiredMessage="Gelieve een einddatum in te vullen."/>
                                <p:inputMask id="Eindtijd" placeholder="Eindtijd"  value="#{event.dto.detail.endTime}" mask="99:99" required="true" requiredMessage="Gelieve een eindtijd in te vullen.">
                                    <f:convertDateTime pattern="HH:mm" timeZone="GMT+0"/>
                                </p:inputMask>
                        </p:row>
                        
                        <p:row>
                                <h:outputLabel for="Klantnaam" value="Klantnaam:" />
                        </p:row>
                        <p:row>
                                <p:selectOneMenu required="true" id="Klant" value="${event.dto.detail.customerName}" style="width:415px; margin-left: 5px;" requiredMessage="Gelieve een klant te kiezen." validatorMessage="Gelieve een bedrijf te kiezen.">
                                    <f:selectItem itemLabel="Kies klant"  noSelectionOption="true" />
                                    <f:selectItems value="${event.dto.customerList}" />
                                </p:selectOneMenu> 
                        </p:row>
                        
                        <p:row>
                                <h:outputLabel for="Bedrijf" value="Bedrijf:" />
                        </p:row>
                        <p:row>
                                <p:selectOneMenu required="true" id="Eventbedrijf" value="${event.dto.detail.eventcompany}" style="width:415px; margin-left: 5px;" requiredMessage="Gelieve een bedrijf te kiezen." validatorMessage="Gelieve een bedrijf te kiezen.">
                                    <f:selectItem itemLabel="Kies bedrijf"  noSelectionOption="true" />
                                    <f:selectItems value="${event.dto.eventcompanyList}" />
                                </p:selectOneMenu>   
                        </p:row>
                        
                        <p:row>
                                <h:outputLabel for="Eventtype" value="Eventtype:" />
                        </p:row>
                        <p:row>
                                <p:selectOneMenu required="true" id="Eventtype" value="${event.dto.detail.eventtype}" style="width:415px; margin-left: 5px;" requiredMessage="Gelieve een eventtype te kiezen." validatorMessage="Gelieve een eventtype te kiezen.">
                                    <f:selectItem itemLabel="Kies eventtype"  noSelectionOption="true" />
                                    <f:selectItems value="${event.dto.eventtypeList}" />
                                </p:selectOneMenu> 
                        </p:row>
                        
                        <p:row></p:row>
                        
                        <p:row>
                        <p:commandButton type="reset" value="Reset" />
                        <p:commandButton id="addButton" value="Toevoegen" actionListener="#{event.add()}" oncomplete="PF('myschedule').update();PF('eventDialog').hide();" />
                        </p:row>
                    </h:panelGrid>
                </p:dialog>    
            </h:form>
 
            
            <h:form>
                <h:messages styleClass="alert alert-danger" p:role="alert"></h:messages>


                <h:inputHidden value="${event.dto.detail.id}"/>

                        <div class="col-md-6-l">
                            <div class="input-group">
                                <span class="input-group-addon">Event Naam</span>
                                <h:inputText label="eventnaam" 
                                             value="${event.dto.detail.eventname}" class="form-control"
                                             required="true" requiredMessage="Vul een eventnaam in. Dit veld kan letters, hoofdletters, '-. en spaties bevatten. (Max. 20 tekens)" validatorMessage="Vul een locatie in. Dit veld kan letters, hoofdletters, '-. en spaties bevatten. (Max. 20 tekens)"
                                             >
                                    <f:validateRegex pattern="^^[A-z][A-z\'-. éèêâôûîëääüïöàç]{1,20}"/>
                                </h:inputText>
                            </div>
                        </div>  
                        <div class="col-md-6-r">
                            <div class="input-group">
                                <span class="input-group-addon">Eventtype</span>
                                <p:selectOneMenu required="true" id="Eventtype" value="${event.dto.detail.eventtype}" style="width:415px; margin-left: 5px;" requiredMessage="Gelieve een eventtype te kiezen." validatorMessage="Gelieve een eventtype te kiezen.">
                                    <f:selectItem itemLabel="Kies eventtype"  noSelectionOption="true" />
                                    <f:selectItems value="${event.dto.eventtypeList}" />
                                </p:selectOneMenu>                          
                            </div>
                        </div> 
                        <div class="col-md-6-l">
                        <div class="input-group">
                            <span class="input-group-addon">Startdatum</span>
                            <p:calendar id="date" value="#{event.dto.detail.startDate}"  pattern="dd/MM/yyyy" />
                                <p:inputMask id="Begintijd" placeholder="Starttijd"  value="#{event.dto.detail.startTime}" mask="99:99" required="true" requiredMessage="Gelieve een starttijd in te vullen.">
                                    <f:convertDateTime pattern="hh:mm" />
                                </p:inputMask>
                            </div>
                        </div>          
                        <div class="col-md-6-r"> 
                            <div class="input-group">
                                <span class="input-group-addon">Einddatum</span>
                                <p:calendar pattern="dd/MM/yyyy" id="popup2"  locale="nl" value="${event.dto.detail.endDate}" required="true" requiredMessage="Gelieve een einddatum in te vullen."/>
                                <p:inputMask id="Eindtijd" placeholder="Eindtijd"  value="#{event.dto.detail.endTime}" mask="99:99" required="true" requiredMessage="Gelieve een eindtijd in te vullen.">
                                    <f:convertDateTime pattern="hh:mm" />
                                </p:inputMask>
                        </div>
                        </div>
                        <div class="col-md-6-l">
                            <div class="input-group">
                                <span class="input-group-addon">Locatie</span>
                                <p:selectOneMenu required="true" id="Locatie" value="${event.dto.detail.locationName}" style="width:415px; margin-left: 5px;" requiredMessage="Gelieve een eventtype te kiezen." validatorMessage="Gelieve een locatie te kiezen.">
                                    <f:selectItem itemLabel="Kies locatie"  noSelectionOption="true" />
                                    <f:selectItems value="${event.dto.locationList}" />
                                </p:selectOneMenu>                          
                            </div>
                        </div> 
                        <div class="col-md-6-r">
                            <div class="input-group">
                                <span class="input-group-addon">Klant</span>
                                <p:selectOneMenu required="true" id="Klant" value="${event.dto.detail.customerName}" style="width:415px; margin-left: 5px;" requiredMessage="Gelieve een bedrijf te kiezen." validatorMessage="Gelieve een bedrijf te kiezen.">
                                    <f:selectItem itemLabel="Kies klant"  noSelectionOption="true" />
                                    <f:selectItems value="${event.dto.customerList}" />
                                </p:selectOneMenu>                                 
                            </div>
                        </div>  
                        <div class="col-md-6">
                            <div class="input-group">
                                <span class="input-group-addon">Eventbedrijf</span>
                                <p:selectOneMenu required="true" id="Eventbedrijf" value="${event.dto.detail.eventcompany}" style="width:415px; margin-left: 5px;" requiredMessage="Gelieve een bedrijf te kiezen." validatorMessage="Gelieve een bedrijf te kiezen.">
                                    <f:selectItem itemLabel="Kies bedrijf"  noSelectionOption="true" />
                                    <f:selectItems value="${event.dto.eventcompanyList}" />
                                </p:selectOneMenu>                                 
                            </div>
                        </div> 

                <div class="col-md-12">
                    <div class="input-group">  
                        <h:commandButton class="button" action="${event.add()}" value="Save" ></h:commandButton>
                    </div> 
                </div>
            </h:form> 

            <br/><br/>
            <h2>Eventoverzicht</h2>
            <ui:include src="dataTables/tableEvent.xhtml"></ui:include>
        </ui:define>

    </ui:composition>
</body>

</html>